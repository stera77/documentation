
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>5. インフラストラクチャ &mdash; The enStratus Documentation Project</title>
    
    <link rel="stylesheet" href="../_static/adctheme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="The enStratus Documentation Project" href="../index.html" />
    <link rel="next" title="6. Platform" href="../platform/platform.html" />
    <link rel="prev" title="4. 自動化" href="../automation/automation.html" />
    <link media="only screen and (max-device-width: 480px)" href="../_static/mobile.css" type="text/css" rel="stylesheet" /> 
  </head>
  <body>
<div id="docstitle">
	<p>The enStratus Documentation Project</p>
</div>
<div id="header">
	<div id="title"><h1>5. インフラストラクチャ</h1></div>
	<ul id="headerButtons">
		<li id="toc_button"><div class="headerButton"><a href="#">Table of Contents</a></div></li>
		<li id="page_buttons">
			<div class="headerButton"><a href="../genindex.html" title="General Index" accesskey="I">index</a></div>
			<div class="headerButton"><a href="../platform/platform.html" title="6. Platform" accesskey="N">next</a></div>
			<div class="headerButton"><a href="../automation/automation.html" title="4. 自動化" accesskey="P">previous</a></div>
			<div class="headerButton"><a href="http://on-premise.enstratus.com">On-Premise</a></div>
			<div class="headerButton"><a href="http://docs.enstratus.com">SaaS</a></div>
			<div class="headerButton"><a href="http://automation.enstratus.com">Advanced Automation</a></div>
			<div class="headerButton"><a href="http://agent.enstratus.com">enStratus Agent</a></div>
		</li>
	</ul>
</div>

<div id="sphinxsidebar">
  <div class="sphinxsidebarwrapper">
	<ul><li class="toctree-l1"><a href="../index.html">Main Page</a></li></ul>
	<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../console/console.html">1. コンソール</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration_management/configuration_management.html">2. 構成管理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration_management/configuration_management.html#id4">3. シェフの使用</a></li>
<li class="toctree-l1"><a class="reference internal" href="../automation/automation.html">4. 自動化</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">5. インフラストラクチャ</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id2">5.1. サーバ</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id10">5.2. マシンイメージ</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ip">5.3. IPアドレス</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id21">5.4. ロード·バランサ</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id25">5.5. ファイアウォール</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id29">5.6. ボリューム</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id36">5.7. スナップショット</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../platform/platform.html">6. Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users/users.html">7. Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../budget/budget.html">8. Budget</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agent/agent.html">9. エージェント</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/api.html">10. API</a></li>
</ul>

    <h3>Downloads</h3>
    <ul><li><a href="http://es-content.s3.amazonaws.com/enstratus-api-latest.pdf">API Specification</a></li>
    <li><a href="http://es-content.s3.amazonaws.com/Security_Architecture.pdf">Security Architecture</a></li>
    </ul>
      <h3>This Page</h3>
      <ul class="this-page-menu">
        <li><a href="../_sources/infrastructure/infrastructure.txt"
               rel="nofollow">Show Source</a></li>
      </ul>
    <div id="searchbox" style="display: none">
      
        <form class="search" action="../search.html" method="get">
			<div class="search-wrapper">
			<span class="search-left"></span>
			<input class="prettysearch" type="text" name="q" size="18" />
			<span class="search-right">&nbsp;</span>
			</div>
          <input type="submit" value="Search" class="searchbutton" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
        <p class="searchtip" style="font-size: 90%">
        Enter search terms or a module, class or function name.
        </p>
    </div>
    <script type="text/javascript">$('#searchbox').show(0);</script>
  </div>
</div>



    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="id1">
<h1>5. インフラストラクチャ<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id2">
<h2>5.1. サーバ<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>enStratusは、アカウント内のすべてのサーバーを監視します。緑色のアクションボタンを使用してサーバにアクセスします。
サーバにenStratusエージェントがインストールされていない場合、利用できるオプションは、サーバ情報の取得、再起動、
一時停止/起動、または終了に限定されています。enStratusエージェントが実行中のサーバーにインストールされている場合は、
追加機能がアクションメニューに含まれています。</p>
<div class="section" id="id3">
<h3>5.1.1. 補足情報<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>情報：サーバの属性に関する拡張情報を表示します。接続された論理ボリューム、使用されたファイルシステム、暗号化、メモリなどの包括的なハードウェア情報を含みます。</li>
<li>分析：過去1時間のCPU負荷のグラフィカルな表現（％）です。</li>
<li>コンソール：ハイパーバイザ情報。</li>
<li>エージェント：エージェントロギングは、ユーザーの追加/削除、ホスト侵入検知システムのアラート、およびカスタマイズ可能な情報メッセージをなどのイベントをキャプチャしています。</li>
</ul>
</div>
<div class="section" id="id4">
<h3>5.1.2. イメージの作成<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>マシンのイメージを作ることは将来の使用のためにサーバの状態の保存されたコピーを作ることを意味します。
マシンのイメージは、タブに表示されます。パッチやアップデートなどのオペレーティングシステムに加えられた変更があるたびに
マシンのイメージは作られるべきです。</p>
</div>
<div class="section" id="id5">
<h3>5.1.3. スナップショットの作成<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>スナップショットを作ることは接続されているすべてのボリュームの差分バックアップの作成を意味します。</p>
</div>
<div class="section" id="id6">
<h3>5.1.4. シェル/リモートアクセス<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>シェル（Linux）とリモート（Windows）のアクセスは、実行中のサーバにユーザーアカウントを作成することです。
enStratus内の各ユーザーは、フォーム P123 のユーザーコードが割り当てられています。リモートアクセスが
Linuxサーバに許可された時、ホームユーザーアカウントが、そのサーバー上で作成され、enStratusの
ユーザープロファイルで定義されたパブリックSSH資格情がユーザに設定されています。Windows上で、
ホームアカウントが作成され、ユーザはenStratusプロファイルに設定されたRDPパスワード使用して、
実行中のサーバーにアクセスすることができます。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">シェル/サーバへのリモートアクセスを許可する前に、ユーザーは自分のユーザープロファイル内に
SSH公開鍵とのRDPパスワードを定義する必要があります。資格情報の変更されても、リモートサーバーに変更が通知されません。新しい資格情報が
使用されていることを確実に知らせるには、変更がアカウントに伝播できるように、最初にユーザーを削除し、
リモートアクセスに再度追加する必要があります。</p>
</div>
</div>
<div class="section" id="id7">
<h3>5.1.5. 再起動<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>実行中のサーバーを再起動します。再起動は、サーバのIPアドレスを変更しません。</p>
</div>
<div class="section" id="id8">
<h3>5.1.6. 一時停止<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>実行中のサーバーを一時停止します。enStratusはまだサーバーを監視しています。 IPアドレスは、起動時に変更されます。</p>
</div>
<div class="section" id="id9">
<h3>5.1.7. 終了<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>インスタンスを終了します。インスタンス上のデータは保存されません。</p>
<p>実行中のサーバーの名前を変更するには、茶色の点線で示されたサーバー名をクリックします。
テキストウィンドウが表示されます。希望する名前を入力し、[OK]を選択します。サーバのホスト名が
変更されます。</p>
<p>実行中のサーバーのラベルの色を変更するには、ラベルの色をクリックして得られた選択肢の中から希望する色を選択します。</p>
</div>
</div>
<div class="section" id="id10">
<h2>5.2. マシンイメージ<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id11">
<h3>5.2.1. 概要<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<p>マシンのイメージは、サーバの保存されたテンプレートです。実行しているサーバーは、マシンのイメージから起動されます。</p>
<p>enStratusイメージを利用してクラウドの作業を開始するしようとしている場合は、このワークフローに従ってください。</p>
<ol class="arabic simple">
<li>提供されたenStratusテンプレート（マシンイメージ）のいずれかからサーバーを起動します。</li>
<li>次に、開始したサーバからマシンイメージを作成します。</li>
<li>提供されたenStratusイメージではなく、仕事で得られたイメージを使用します。</li>
</ol>
<p><a href="#id12"><span class="problematic" id="id13">*</span></a>なぜ*？</p>
<p>我々は定期的に使用可能なenStratusイメージを更新し、それを行うとき、我々はクラウドリソースの良い
スチュワードで有るべく、古いものを削除します。実行中のサーバのバッキングイメージが削除された場合、
それは今後のイメージングの問題につながる可能性があります。それは実行中のサーバには影響しません。</p>
<p>マシンイメージに含まれる機能は、基盤となるクラウドプロバイダーにより異なります。
いくつかのクラウドプロバイダーは、イメージの公開データベースへのアクセスが許可していますから
それからプライベートサーバを開始することができます。enStratusはマシンイメージを公開しているので
検索し、任意の使用可能なマシンイメージを開始できます。</p>
</div>
<div class="section" id="id14">
<h3>5.2.2. 名前の変更<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<p>マシンイメージの名前を変更するには、茶色の点線で示されたイメージ名をクリックします。
テキストウィンドウが表示されます。希望する名前を入力し、[OK]を選択します。</p>
<p>マシンイメージのラベルの色を変更するには、ラベルの色をクリックして選択して
得られた選択肢の中から色を希望します。</p>
</div>
<div class="section" id="id15">
<h3>5.2.3. 出発<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<p>マシンイメージからサーバーを起動するには、緑色のアクションボタンをクリックして起動を選択します。
ダイアログボックスには、カスタマイズ可能な起動オプションが表示されます。</p>
<p>いくつかの起動パラメータが基盤となるクラウドプロバイダーから提供される機能によって管理されています。
ほとんどのクラウドプロバイダーは、サーバにプロビジョニングされるハードウェア（CPU、メモリ、ストレージ）
の量のカスタマイズを可能にしています。</p>
</div>
<div class="section" id="id16">
<h3>5.2.4. セキュリティグループ<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<p>ファイアウォール形式のセキュリティパラメータまたはセキュリティグループも同じくサーバ起動時に選択されます。</p>
<p>enStratusはグループ化および課金コードの形で追加機能をすべてのクラウドプロバイダーのサーバーの起動に置きます。</p>
</div>
<div class="section" id="id17">
<h3>5.2.5. キーペア<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h3>
<p>いくつかのクラウドプロバイダーでは、サーバーがルートキーペアを持って開始することができます。enStratusでも
このような機能を提供でき、ユーザーが既存のキーペアセットから選択することや、起動時に新規キーペアを作成することができます。</p>
</div>
<div class="section" id="id18">
<h3>5.2.6. ボリューム<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h3>
<p>さらに、いくつかのクラウドプロバイダーを介してボリュームグループを接続するように指定し、
フォーマット、RAID構成に入れる、オプションで起動時に暗号化することが可能です。</p>
<p>サーバが起動すれば、通常20分未満でサーバーの使用準備ができます。</p>
</div>
<div class="section" id="id19">
<h3>5.2.7. やること:<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>起動プロセス</li>
<li>スクリーンショット</li>
</ol>
</div>
</div>
<div class="section" id="ip">
<h2>5.3. IPアドレス<a class="headerlink" href="#ip" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id20">
<h3>5.3.1. 概要<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h3>
<p><em>IPアドレス 実行中のサーバに割り当てることができる静的IPアドレスの予約を可能にします。</em></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">IPアドレスの予約は全てクラウドの中で利用できるとは限らない機能です。もしそれが、クラウドプロバイダに
よってサポートされている機能でない場合は、enStratusはコンソールにそれを提示しません。</p>
</div>
<p>IPアドレスを予約するには、メニューウィンドウ内の+ reserve_addressをクリックして、eserve IP Address を選択します。
新規のIPアドレスがアクティブなアドレスのリストに追加されます。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Amazonのクラウドでは、5個の予約済みIPアドレスの制限があります。もっと多く予約する場合は、
Amazon Webサービスに問い合わせる必要があります。</p>
</div>
<p>IPアドレスが予約されたならば、実行中のサーバに割り当てて使用することが可能です。
サーバーにIPアドレスを割り当てるには、緑色のアクションボタンを選択し、アサインを選択します。
使用可能なサーバーのドロップダウンリストを持つダイアログボックスがで表示されます。
リストからサーバを選択し、割り当てアドレスを選択します。
割り当てが行われるには少し時間がかかります。</p>
<p>アドレスがすでにサーバーに割り当てられ、代わりに除去するために設定されている場合は、アクションボタン
をクリックしてリリースオプションを選択します。このアクションはまた、いくらかの時間を要します。</p>
<p>ヒント：未使用の予約されたIPは、それらが割り当てられていないにもかかわらず、実行中のサーバには依然として
コストがかかります。IPアドレスを削除するには、アクションボタンをクリックし、[削除]を選択します。
結果表示のダイアログボックスで、削除を確認するとあなたのアカウントからIPアドレスが削除されます。</p>
</div>
</div>
<div class="section" id="id21">
<h2>5.4. ロード·バランサ<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h2>
<p>成功したアプリケーションのロードバランシングは負荷分散プールにアプリケーションノードを動的に
追加したり、そこから削除することを含みます。この議論は、ロードバランサ上の動作にのみ関心を制限します。</p>
<div class="section" id="id22">
<h3>5.4.1. 概要<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h3>
<p>enStratusは、広い範囲のロードバランサをサポートしています。Amazonのクラウドでは、 Elastic Load Balancers を
、enStratus内からプロビジョニングして利用可能です。サーバベースのロードバランサを使用するために開始する
ことができ、または既存のサーバーをHA-ProxyまたはAJP（mod_jk）経由でロードバランサとして利用する
ことができます。最後に、サードパーティ製の負荷分散ソリューションが Zeus load balancer の形態で利用可能です。</p>
</div>
<div class="section" id="elastic-load-balancer">
<h3>5.4.2. Elastic Load Balancer<a class="headerlink" href="#elastic-load-balancer" title="Permalink to this headline">¶</a></h3>
<p>Elastic Load Balancer は、Amazon Webサービスからのオファリングで、enStratusでも良くサポートされています。
ELBはサーバーベースのソリューションより安く動作できますので、有利です。
ELBの構成要件は、多くの場合、サーバーベースのロード·バランシングを使用するよりも簡単です。</p>
<p>enStratusを使用して、新規の elastic load balancer をプロビジョンするには、インフラストラクチャに移動し、ロード
バランサに移動します。 + create_load_balancerを選択します。１つのダイアログボックスがロードバランサ必要な構成
オプションを提示します。</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/createELB1.png"><img alt="Create ELB" src="../_images/createELB1.png" style="width: 380.0px; height: 285.0px;" /></a>
<p class="caption">Create ELB</p>
</div>
</div>
<div class="section" id="elb">
<h3>5.4.3. ELBディスカッション<a class="headerlink" href="#elb" title="Permalink to this headline">¶</a></h3>
<p>名前、ラベル、および説明フィールドが自明でなければなりません。ダイアログボックスのデータセンターの部分を
構成するときにはより多くのケアがなければならないことに注意。それぞれの構成されたデータセンターは
ロードバランサに入るトラフィックの等しい部分を受け取ることになります。これは、設定されている
各データセンターでは、負荷分散されたトラフィックをてきぱき処理する &#8220;listening&#8221; アプリケーション
サーバーがあるはずという意味です。</p>
<p>たとえば、我々は us-east-1a と us-east-1b のデータセンターのために設定されたロードバランサを
持っていると仮定しましょう。つまり、ロードバランサに到達したインバウンドトラフィックの50％が us-east-1a に
関連したサーバーに送信され、着信トラフィックの50％が us-east-1b 内のサーバーに送信されます。
どのサーバーもデータセンターでプロビジョニングされていない場合、トラフィックはエラーとして明示されます。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">ロードバランサが作成された後でも追加のデータセンターを再構成することは可能です。
さらに、クラスタ環境で、enStratusは、ロードバランサと関連付けられていないデータセンター内
のどのサーバーも開始する必要がないことを認識しています。</p>
</div>
<p>課金コードとユーザーグループは、課金コードとユーザーグループの属性で、enStratusが
ユーザー管理とenStratusの課金コードオファリングに関連付けられた請求料金とアクセス権を追跡
するために使用します。</p>
<p>elastic load balancer を構成する最後のステップは、ロードバランサを通過するプロトコルを設定
することです。設定にはHTTP、HTTPS、AJP、およびRAW TCPを含むいくつかのプロトコルが使用可能です。
この記事の執筆時点で、 elastic load balancer でSSLトラフィックの終点となることは可能ではありません。
SSLトラフィック利用するようにELBを設定するには、RAW TCPプロトコルを使用して、ポート443を通過するか、
またはSSLトラフィックに使用する任意のポートを利用することです。</p>
<p>ELBが設定されていると、それはロードバランサリスト内で利用できるロードバランサとして表示されます。
。</p>
<p>ロードバランサのアクションボタンをクリックすると、ELBの設定を変更することができます。
サーバー管理は現在実行中のサーバーを実行中のELBに関連付けることができます。
管理ゾーンは、ゾーンの関連付けを追加または削除が可能になります。たとえば、もはや現在のバランサーが動作
しているゾーンで実行中のサーバーがなくなった場合は、そのゾーンからELBを削除する必要があります。</p>
<p>最後に、既存のELBを削除するには、アクションメニューの下にある[削除]オプションを選択します。</p>
</div>
<div class="section" id="elb-cname">
<h3>5.4.4. ELB と CNAME<a class="headerlink" href="#elb-cname" title="Permalink to this headline">¶</a></h3>
<p>ELBに関してもう1つの重要な項目は、ドメイン名が解決される方法です。各ELBは、
次の形式のホスト名を持っています。：CompanyName-LB-1234567890.us-east-1.elb.amazonaws.com.</p>
<p>ここで、クライアントがアプリケーションによって提供されるURLを要求したときに何が起こるかの
ステップバイステップのフローは：</p>
<p>ドメイン名の名前解決要求は、あなたのウェブサーバ www.yourdomain.com に対して試行されている場合、
DNSは CompanyName-LB-1234567890.us-east-1.elb.amazonaws.com. のCNAMEエイリアスを使用して応答します。
次に、クライアントの要求はELBの名前 CompanyName-LB-1234567890.us-east-1.elb.amazonaws.com. を解決
しようとします。</p>
<p>それがドメイン amazonaws.com の一部であるので、Amazon Web Servicesがこのドメイン名を制御します。
アマゾンのDNSサーバーはELB、111.222.222.111のアドレスを返します。
クライアント接続がこのIPアドレスから始まります。ELBは指示通りにこのIPアドレスを介してサーバの
バランスのとれたプールにトラフィックを渡すことができます。</p>
</div>
<div class="section" id="mod-jk">
<h3>5.4.5. mod-jk<a class="headerlink" href="#mod-jk" title="Permalink to this headline">¶</a></h3>
<p>ロードバランシングアプリケーションでの第2の一般的な方法は、mod_jkを使用することです。 mod_jkの使用は
現在enStratusでサポートされている仮想マシンベースの負荷分散の2つのタイプの一つです。
enStratusはenStratusエージェントの一部である5つの mod_jk スクリプト経由でmod_jkでバランスがとられた
アプリケーションを管理します。これらのスクリプトは、 /enstratus/bin/ に配置されています。</p>
<ol class="arabic simple">
<li>modjk-addAddress &#8211; ワーカープールにアドレスを追加します。</li>
<li>modjk-buildWorkers &#8211; workers.listファイルを作成します。</li>
<li>modjk-removeAddress &#8211; ワーカープールからアドレスを削除します。</li>
<li>modjk-startProxy &#8211; プールにワーカーを追加するために必要なパラメータを指定してmodjk-addAddressを呼び出します。</li>
<li>modjk-stopProxy &#8211; プールからワーカーを削除するために必要なパラメータを指定してmodjk-removeAddressを呼び出します。</li>
</ol>
</div>
<div class="section" id="modjk">
<h3>5.4.6. modjk エージェント　スクリプト<a class="headerlink" href="#modjk" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="81%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">ｴｰｼﾞｪﾝﾄ ｽｸﾘﾌﾟﾄ</th>
<th class="head">機能</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>modjk-addAddress</td>
<td>ワーカープールにアドレスを追加します。</td>
</tr>
<tr class="row-odd"><td>modjk-buildWorkers</td>
<td>workers.listファイルを作成します。</td>
</tr>
<tr class="row-even"><td>modjk-removeAddress</td>
<td>ワーカープールからアドレスを削除します。</td>
</tr>
<tr class="row-odd"><td>modjk-startProxy</td>
<td>プールにワーカーを追加するために必要なパラメータを指定してmodjk-addAddressを呼び出します。</td>
</tr>
<tr class="row-even"><td>modjk-stopProxy</td>
<td>ﾌﾟｰﾙ からワーカーを削除するために必要なﾊﾟﾗﾒｰﾀを指定してmodjk-removeAddressを呼び出します。</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">このための drop-in point と他の種類のロードバランシングがあります。スクリプト /enstratus/bin/startProxy と
スクリプト /enstratus/bin/stopProxy です。</p>
</div>
</div>
<div class="section" id="ha-proxy">
<h3>5.4.7. HA-Proxy<a class="headerlink" href="#ha-proxy" title="Permalink to this headline">¶</a></h3>
<p>負荷分散のための別の一般的な方法は、高可用性のプロキシまたはHA-Proxyを使用方法です。
このメソッドは、enstratusが積極的に支援する、他のタイプの仮想マシンベースのロードです。
HA-Proxyはカスタマイズ性と拡張性に優れていますが、サポートスクリプトは、
最も基本的なプロキシのために配置されています。ただし、スクリプトは、カスタマイズと拡張性の
ために開かれています。これらは /enstratus/bin/に配置されています。</p>
<p>haproxy-addService &#8211; バランスされたノードに/etc/haproxy.cfg と自動インクリメントを追加します。
haproxy-runLb &#8211; 開始時に haproxy が動作することを保証します。 haproxy-startProxy &#8211; ﾌﾟﾛｷｼｻｰﾋﾞｽを
制御するための基本的な /etc/haproxy.cfg ｽｸﾘﾌﾟﾄを作成します。 haproxy-stopProxy &#8211; /etc/haproxy.cfg から
バランスされたノードを削除します。</p>
</div>
<div class="section" id="id23">
<h3>5.4.8. HA-Proxy エージェント　スクリプト<a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">ｴｰｼﾞｪﾝﾄ ｽｸﾘﾌﾟﾄ</th>
<th class="head">機能</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>haproxy-addService</td>
<td>バランスされたノードに/etc/haproxy.cfg と自動インクリメントを追加します。</td>
</tr>
<tr class="row-odd"><td>haproxy-runLb</td>
<td>開始時に haproxy が動作することを保証します。</td>
</tr>
<tr class="row-even"><td>haproxy-startProxy</td>
<td>ﾌﾟﾛｷｼｻｰﾋﾞｽを制御するための基本的な /etc/haproxy.cfg ｽｸﾘﾌﾟﾄを作成します。</td>
</tr>
<tr class="row-odd"><td>haproxy-stopProxy</td>
<td>/etc/haproxy.cfg からバランスされたノードを削除します。</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">このための drop-in point と他の種類のロードバランシングあります。
スクリプト /enstratus/bin/startProxy と /enstratus/bin/stopProxy です。</p>
</div>
<p>いずれのタイプの仮想マシン·ベースのロードバランシングも、その基本となるマシンイメージが、
その中にサポートしているバイナリが入っている必要があります。
ロードバランシングを実行するのに仮想マシンを使用する利点は次のとおりです。:</p>
<p>ロードバランサで SSL終端が可能です。細粒度のロードバランサの構成制御。
サードパーティ製のプラグインの拡張機能。 DNSラウンドロビン構成の中で新規にロードバランサを追加する。
ロードバランサを実行するのに仮想マシンを使用する欠点は、次のとおりです。:
。</p>
<p>仮想マシンを実行するためのコストは、一般的にELBを使用する場合よりも高くなっています。
構成の複雑さが増加します。</p>
</div>
<div class="section" id="zeus">
<h3>5.4.9. Zeus<a class="headerlink" href="#zeus" title="Permalink to this headline">¶</a></h3>
<p>この議論のためのアプリケーションの負荷分散の最後の方法は、ゼウスのロードバランサです。</p>
<p>ゼウスは、高可用性と高パフォーマンスの負荷分散のための非常に強力なソリューションです。
それはenStratusで利用可能です。自動スケーリングとリカバリ動作のデモはここで見ることができます。:</p>
<p><cite>Rackspaceでのゼウスのロード·バランシング &lt;http://www.youtube.com/watch?v=jRPNhQSPrws&gt;</cite> _</p>
<p>ゼウスのロードバランサの機能を制御するエージェントスクリプトは、/enstratus/bin/ にあります。。</p>
</div>
<div class="section" id="id24">
<h3>5.4.10. やること:<a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>tutorials へのリンク</li>
<li>エージェントディスカッション へのリンク</li>
</ol>
</div>
</div>
<div class="section" id="id25">
<h2>5.5. ファイアウォール<a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h2>
<p>enStratusにおいて、ファイアウォール、またはセキュリティグループは実行中のサーバーへのアクセシビリティを
コントロールします。各アカウントは、&#8217;default&#8217;と呼ばれるデフォルトのファイアウォールを持っていて、すべての
サーバの中で起動されます。</p>
<div class="admonition note">
<p class="first last admonition-title">Note</p>
</div>
<p>ファイアウォールとセキュリティグループの用語のはenStratus内で互換性があります。</p>
<p>セキュリティグループは、サーバーに適用されます。サーバーは、セキュリティグループの一部です。サーバは
サーバ起動時にセキュリティグループに追加されます。現在のところ起動後にはサーバーのセキュリティグループの
変更はできません。このことは、セキュリティグループを構成する個々の規則は何時でも変更できますので聞こえより
はるかに制限は少ないです。</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/securityGroups1.png"><img alt="Security Groups" src="../_images/securityGroups1.png" style="width: 475.0px; height: 285.0px;" /></a>
<p class="caption">Security Groups</p>
</div>
<p>一般的には、ファイアウォールの管理プロセスは、最初にセキュリティグループを作成することであり、
その後、起動時にサーバが属するセキュリティグループを選択します。</p>
<p>enStratusコンソールでファイアウォールにアクセスするには、 Infrastructure &gt; Firewalls に移動します。
アクティブなファイアウォールのリストが表示されます。新しいファイアウォールを追加するには、 +create_firewall をクリックします。
ファイアウォールを作成するためは名、課金コード、およびオプションのグループの2つの情報のみが必要されています。
。</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/createFirewall1.png"><img alt="Create Security Group" src="../_images/createFirewall1.png" style="width: 375.0px; height: 187.5px;" /></a>
<p class="caption">Create Security Group</p>
</div>
<p>ファイアウォールが保存されれば、アクティブなファイアウォールのリストに追加されます。
新規サーバの起動時にファイアウォールがアクティブになれば、それがオプションとして提供されます。</p>
<div class="section" id="id26">
<h3>5.5.1. ファイアウォールの編集<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h3>
<p>既存のファイアウォールを編集するには、編集の対象となるファイアウォールに対応する緑色のアクションボタンを選択します。
ダイアログボックスには、ファイアウォールを構成するルールを示す表示されます。</p>
<p>ファイアウォールを構成する6つのカラムは、次のとおりです。</p>
<p>1. ソース - ファイアウォールルールの共通名。このカラムには標準的なネットワークの命名規則が適用されます。
標準的なネットワークが使用されている場合は、CIDRのカラムには自動的に標準的なネットワークで定義されている
情報が割り当てられます。</p>
<p>2. CIDR - CIDRはクラスレスのドメイン間ルーティングを意味します。実際に、これは/または &#8220;スラッシュ&#8221;表記法が
必要となることをを意味します。たとえば、1つのIPアドレスにルールを適用するには、ルールは形式：1.2.3.4/32 を取ります。
これはホームIPアドレスのルールを作成するための実用的ルールです。この表記の種類は、IPアドレスの範囲を包含
するファイアウォールルールを可能にします。例えば、256のIPアドレスの範囲にルールを適用するには形式：1.2.3.0/24 と表記します。
これは、ファイアウォールルールの作成の非常に強力な機能です。</p>
<p>3. メソッド - これは使用されているプログラムを参照し、プログラムの一般的な名前を提供します。
たとえば、MySQLまたはSSHです。標準ポートは、ルールセットのこの部分を変更するために使用することができます。
プロトコル、 From Port と To Port は自動的に標準ポートで提供される情報が割り当てられます。</p>
<ol class="arabic simple" start="4">
<li>プロトコル - TCP、UDP、またはICMPを適用するプロトコルのタイプを示します。</li>
</ol>
<ol class="arabic simple" start="5">
<li>From Port - ルールの開始ポートを指定します。</li>
</ol>
<ol class="arabic simple" start="6">
<li>To Port - ルールの終了ポートを指定します。</li>
</ol>
</div>
<div class="section" id="id27">
<h3>5.5.2. 標準ネットワークとポート<a class="headerlink" href="#id27" title="Permalink to this headline">¶</a></h3>
<p>enStratusは、ファイアウォールに標準的なネットワークの概念を導入しています。
標準的なネットワークはユーザ定義の一般的に使用されるネットワークで、指定IPアドレスにマッピングされた一般的な名前を
使用して、ファイアウォールにすぐに追加することができます。
この機能は、次の利点を生みだします。それは特定のファイアウォールルールのどんなに長いリストであってもその中から
簡単に識別できること、追加、および削除できることです。</p>
<p>たとえば、ユーザーが通常、特定のオフィスのIPアドレスから接続している場合は、このアドレスは、
標準的なネットワークとして追加され、容易に識別するために適切な名前を付ける必要があります。</p>
<p>同様に、標準のポートは、通常に特定のアプリケーションにマッピングされる、ユーザー定義の一般的に
使用されるポートです。例えば、もしアプリケーションがポート5555上の接続を許可する必要があるとき、
標準ポートを共通の名前で、そのアプリケーションを識別するために定義して、ファイアウォールに追加
することができます。</p>
<p>標準ネットワークは、 Company Settings &gt; Standard Networks で定義されています。すべてのenStratus
アカウントはenStratusの監視サービスが実行中のサーバに接続することを許可にするためにデフォルトの
ファイアウォールで定義されているいくつかのデフォルトルールを持っています。
新しい標準的なネットワークを定義するには、+add_new_standard_network を選択し、その結果として表示
されるダイアログボックスを完了します。</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/addStandardNetwork1.png"><img alt="Standard Network" src="../_images/addStandardNetwork1.png" style="width: 380.0px; height: 285.0px;" /></a>
<p class="caption">Standard Network</p>
</div>
<p>標準的なネットワークが保存されると、それは標準的なネットワークのリストに追加されます。</p>
<p>ファイアウォールの編集に戻る前に、標準のポートを定義しましょう。Company Settings &gt; Standard Portsに
移動します。新規の標準ポートを追加するには +add_new_standard_port を選択して、
表示されるダイアログボックスを完了します。</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/addStandardPort1.png"><img alt="Standard Port" src="../_images/addStandardPort1.png" style="width: 380.0px; height: 285.0px;" /></a>
<p class="caption">Standard Port</p>
</div>
<p>標準のポートが保存されると、それは標準的なポートの一覧に追加されます。</p>
<p>ファイアウォールの編集に再び戻って、&#8221; Office IP &#8220;と呼ばれる新規の標準的なネットワーク
と&#8221; Custom Application &#8220;と呼ばれる標準ポートは迅速に既存のどのファイアウォールにも追加することができます。</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/editFirewall1.png"><img alt="Edit Firewall Using Standard Port" src="../_images/editFirewall1.png" style="width: 675.0px; height: 120.0px;" /></a>
<p class="caption">Edit Firewall Using Standard Port</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">標準のネットワークまたはポートが削除された場合、ルールはまだファイアウォールに適用されているので、
それは与えられたカスタマイズされた名前を失い、[カスタム設定]ルールに戻るだけです。</p>
</div>
</div>
<div class="section" id="id28">
<h3>5.5.3. セキュリティグループ内のサーバーの起動<a class="headerlink" href="#id28" title="Permalink to this headline">¶</a></h3>
<p>クラウドでファイアウォールを利用するの最後のステップは、新規サーバーを起動する時にファイアウォールグループ
を適用することです。新規サーバーを起動するには、 Infrastructure &gt; Machine Images に移動します。
起動するイメージを選択し、表示されるダイアログボックスで、起動されたサーバーに適用するセキュリティグループを
選択します。セキュリティグループを構成するすべてのルールがサーバに適用されます。
。</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/startServerinFirewall1.png"><img alt="Start Server in Firewall" src="../_images/startServerinFirewall1.png" style="width: 425.0px; height: 340.0px;" /></a>
<p class="caption">Start Server in Firewall</p>
</div>
</div>
</div>
<div class="section" id="id29">
<h2>5.6. ボリューム<a class="headerlink" href="#id29" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id30">
<h3>5.6.1. 概要<a class="headerlink" href="#id30" title="Permalink to this headline">¶</a></h3>
<p>ボリュームは、ブロックストレージを表します。概念的には、ストレージデバイスは、クラウド内のデータを永続的な方法で
格納するために使用することができます。</p>
</div>
<div class="section" id="id31">
<h3>5.6.2. ボリュームの作成<a class="headerlink" href="#id31" title="Permalink to this headline">¶</a></h3>
<p>新規のボリュームを作成するには、 Infrastructure &gt; Volumes に移動します。
ボリュームが以前にenStratus内またはクラウドプロバイダのいずれかを介して作成されていた場合、それらは
ボリュームテーブルに表示されます。 +create_volume を選択し、表示されるダイアログボックスを完了します。</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/createVolume1.png"><img alt="Create Volume" src="../_images/createVolume1.png" style="width: 380.0px; height: 285.0px;" /></a>
<p class="caption">Create Volume</p>
</div>
<p>ボリュームの名前はenStratus内でボリュームを参照するために使用される論理名です。
ボリュームのサイズは1〜1000ギガバイト（1 TB）である必要があります。</p>
<p>ボリュームは同じゾーン内のサーバーのみに取り付けることができるため、ボリュームが作成されるゾーンは重要です。
課金コードとグループはボリュームの作成オプションを完了します。</p>
<p>ボリュームの作成が完了するまでほんの数分しかかかりません。一度ボリュームが作成されると、それは、
ボリュームのリストに追加されます。新しく作成されたボリュームは、サーバーに接続されていないので、
デバイスと現在のサーバーのカラムは空白になります。</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/finishedVolume1.png"><img alt="Volume Created" src="../_images/finishedVolume1.png" style="width: 800.0px; height: 200.0px;" /></a>
<p class="caption">Volume Created</p>
</div>
</div>
<div class="section" id="id32">
<h3>5.6.3. ボリュームの接続<a class="headerlink" href="#id32" title="Permalink to this headline">¶</a></h3>
<p>ボリュームとサーバーは、ボリュームの接続が成功するためには可用性ゾーンを共有する必要があります。
ボリュームは、ブロックストレージデバイスとして接続された時は、パーティション作成もフォーマットもされていません。
enStratusは、新規サーバーを起動する場合にのみ自動化された接続、フォーマッティング、新規ボリュームのマウンティングを
可能にします。</p>
<p>サーバーへボリュームをアタッチするには、接続するボリュームを選択し、緑色のアクションボタンを選択します。
ボリュームをアタッチするための唯一の必要な情報はボリュームが接続されるサーバーの名前です。
アベイラビリティゾーンを共有するサーバーのリストはドロップダウンセレクタに存在します。</p>
<p>オプションとして、デバイス名を、ボリュームのために選択することができます。このケースでは、選択した
デバイス名の sdh は、デバイスがサーバー上では /dev/sdh として表示されることを意味します。</p>
<div class="highlight-bash"><pre>p335@ApplicationServer:~$ sudo fdisk -l

Disk /dev/sdh: 2147 MB, 2147483648 bytes 255 heads, 63 sectors/track, 261 cylinders Units
= cylinders of 16065 * 512 = 8225280 bytes Sector size (logical/physical): 512 bytes / 512
bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disk identifier: 0x00000000

Disk /dev/sdh doesn't contain a valid partition table</pre>
</div>
<p>ボリュームが接続されれば、やや外部ハードドライブがサーバーに接続されているかのようにみなして、
扱うことができます。パーティショニング、フォーマット、およびマウントを含む標準的な
ハードディスクドライブのアクティビティを利用できます。</p>
</div>
<div class="section" id="id33">
<h3>5.6.4. スナップショットの作成<a class="headerlink" href="#id33" title="Permalink to this headline">¶</a></h3>
<p>スナップショットはボリュームから作成され、ボリュームがスナップショットから作成されます。</p>
<p>ボリュームのスナップショットはボリュームに含まれるデータの差分バックアップを表します。
これは、変更されたブロックのみがスナップショットが作成されるたびにを保存されることを意味します。
スナップショットを作成するには、ボリュームの緑色のアクションボタンを選択し、
make_snapshotを選択します。スナップショットを作成するために必要な情報はスナップショットの論理的名前だけです。
スナップショットが保存されると、スナップショットは、enStratusコンソールのスナップショットのページで表示されます。</p>
</div>
<div class="section" id="id34">
<h3>5.6.5. ボリュームの削除<a class="headerlink" href="#id34" title="Permalink to this headline">¶</a></h3>
<p>ボリュームを削除するには、ボリュームに関連付けられた緑色のアクションボタンをクリックして[削除]を選択します。
現れたダイアログボックスで、表示されたプロンプトに応じてアクションを確認すると
ボリュームがボリュームリストから削除されます。</p>
</div>
<div class="section" id="id35">
<h3>5.6.6. ボリューム戦略<a class="headerlink" href="#id35" title="Permalink to this headline">¶</a></h3>
<p>ボリュームストレージは、しばしば、それが接続されたサーバの寿命を超えて永続的です。
これはボリュームがクラウドでデータストレージを管理するための非常に有用なアイテムになります。
高可用性の障害トレラント自動化された環境において、enStratusは、データ損失することなく
アプリケーションを復元しボリュームを動作状態に戻すことに活用します。</p>
</div>
</div>
<div class="section" id="id36">
<h2>5.7. スナップショット<a class="headerlink" href="#id36" title="Permalink to this headline">¶</a></h2>
<p>スナップショットはボリュームの相反です。ボリュームのスナップショットが作成されたときに、
デバイスの差分バックアップが作成され、S3に格納されます。このスナップショットから、
元のボリュームのクローンを作成することができます。 enStratusは、スナップショットのプロパティを
アプリケーション配備の自動化に利用しています。これを書いている時点でスナップショットの作成は、
Amazon EC2クラウドでのみサポートされています。</p>
<div class="section" id="id37">
<h3>5.7.1. スナップショットからのボリュームの作成<a class="headerlink" href="#id37" title="Permalink to this headline">¶</a></h3>
<p>スナップショットからボリュームを作成することは、スナップショットが来たボリュームの正確な複製を
作成する方法です。ボリューム上のファイルシステムがボリュームのサイズを大きくすることがサポート
されている場合、スナップショットから作成されたボリュームのサイズを増加することができます。</p>
<p>スナップショットから作成されたボリュームは、元のボリュームのサイズ以上でなければなりません。</p>
<p>スナップショットからボリュームを作成するには、 Infrastructure &gt; Snaphots に移動してスナップショットを
選択します。適切なアクションボタンをクリックし create_volume を選択します。現れたダイアログボックスでは
標準enStratusオプションの名前、グループ、および課金コードを含む、いくつかのオプションをカスタマイズする
ことができます。</p>
<p>sizeフィールドは自動的に元のボリュームのサイズが割り当てられますが、増加することができます。
アマゾンでは、ボリュームはアベイラビリティゾーンに固有であり、それでゾーンはボリュームの作成に必要です。</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/createVolumeFromSnapshot1.png"><img alt="Create Volume from Snapshot" src="../_images/createVolumeFromSnapshot1.png" style="width: 475.0px; height: 285.0px;" /></a>
<p class="caption">Create Volume from Snapshot</p>
</div>
<p>作成されたボリュームは、すぐに Infrastructure &gt; Volumes page で選択とサーバーへの接続のために表示されます。</p>
</div>
<div class="section" id="id38">
<h3>5.7.2. 共有スナップショット<a class="headerlink" href="#id38" title="Permalink to this headline">¶</a></h3>
<p>時には別のアカウントと、スナップショットを共有することはデータ転送を容易にするために有利です。
enStratusで共有スナップショットは、&#8221;snapshot to share&#8221; を選択してアクションボタンをクリックする
ことによって達成されます。</p>
<p>2つの主要オプションを持ったダイアログボックスが表示されます。最初の共有タイプはPrivateです。
プライベート共有は、複数のアカウントの一部であるenStratusユーザーがこれらのアカウントの間で
スナップショットを共有することを可能にします。ユーザーが属しているグループのアカウントにはドロップダウンウィンドウが
置かれます。スナップショットが共有されると、スナップショットは、他のアカウントにも表示されます。</p>
<p>２番目の共有タイプは、Publicです。パブリックの共有はenStratusユーザーがスナップショットを
パブリックに利用可能なスナップショットのプールに追加することを可能にします。これは公的に利用可能な
プライベートデータを作るリスクを運ぶオプションですので、このアクションをenStratusのグループと
ロールに使用するのは制限すべきです。</p>
</div>
<div class="section" id="id39">
<h3>5.7.3. スナップショットの戦略<a class="headerlink" href="#id39" title="Permalink to this headline">¶</a></h3>
<p>スナップショットは差分バックアップであるため、スナップショット作成にかかる時間は最後のスナップショットが
取られて以来変更された情報の量に基づいて異なります。頻繁なスナップショットは一般的に、
まれなものよりもより迅速に作成されます。</p>
<p>enStratusで自動化された環境では、enStratusがカスタマイズ可能なスケジュールに従っての、スナップショット作成
および復元ボリューム作成の両方を自動化することは可能です。
。</p>
</div>
</div>
</div>


          </div> 
        </div>
      </div>
    <div class="footer">
    <p>
      &copy; Copyright 2012, enStratus Networks Inc..
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
	</p>
    </div>
      <div class="clearer"></div>
    </div>
	<div id="breadcrumbs">
		5. インフラストラクチャ
		</ul>
	</div>
	<script type="text/javascript" charset="utf-8" src="../_static/toc.js"></script>
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30212947-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>
  </body>
</html>