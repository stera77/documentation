
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>4. 配備構成 &mdash; The enStratus Documentation Project</title>
    
    <link rel="stylesheet" href="../_static/adctheme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="The enStratus Documentation Project" href="../index.html" />
    <link rel="next" title="5. Deployment Operation" href="../deployment_operation/deployment_operation.html" />
    <link rel="prev" title="3. サービス" href="../services/services.html" />
    <link media="only screen and (max-device-width: 480px)" href="../_static/mobile.css" type="text/css" rel="stylesheet" /> 
  </head>
  <body>
<div id="docstitle">
	<p>The enStratus Documentation Project</p>
</div>
<div id="header">
	<div id="title"><h1>4. 配備構成</h1></div>
	<ul id="headerButtons">
		<li id="toc_button"><div class="headerButton"><a href="#">Table of Contents</a></div></li>
		<li id="page_buttons">
			<div class="headerButton"><a href="../genindex.html" title="General Index" accesskey="I">index</a></div>
			<div class="headerButton"><a href="../deployment_operation/deployment_operation.html" title="5. Deployment Operation" accesskey="N">next</a></div>
			<div class="headerButton"><a href="../services/services.html" title="3. サービス" accesskey="P">previous</a></div>
			<div class="headerButton"><a href="http://on-premise.enstratus.com">On-Premise</a></div>
			<div class="headerButton"><a href="http://docs.enstratus.com">SaaS</a></div>
			<div class="headerButton"><a href="http://automation.enstratus.com">Advanced Automation</a></div>
			<div class="headerButton"><a href="http://agent.enstratus.com">enStratus Agent</a></div>
		</li>
	</ul>
</div>

<div id="sphinxsidebar">
  <div class="sphinxsidebarwrapper">
	<ul><li class="toctree-l1"><a href="../index.html">Main Page</a></li></ul>
	<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/introduction.html">1. はじめに</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/overview.html">2. 概要</a></li>
<li class="toctree-l1"><a class="reference internal" href="../services/services.html">3. サービス</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">4. 配備構成</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id4">4.1. ユーザー　インタフェース</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id6">4.2. 配備管理</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id9">4.3. ロード·バランサ</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id11">4.4. マシンイメージ/テンプレート</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id14">4.5. サービス</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id15">4.6. データ·ソース</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id16">4.7. ボリューム</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id17">4.8. 起動構成</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tier">4.9. Tier</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ssl">4.10. SSL</a></li>
<li class="toctree-l2"><a class="reference internal" href="#backups">4.11. Backups</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../deployment_operation/deployment_operation.html">5. Deployment Operation</a></li>
</ul>

    <h3>Downloads</h3>
    <ul><li><a href="http://es-content.s3.amazonaws.com/enstratus-api-latest.pdf">API Specification</a></li>
    <li><a href="http://es-content.s3.amazonaws.com/Security_Architecture.pdf">Security Architecture</a></li>
    </ul>
      <h3>This Page</h3>
      <ul class="this-page-menu">
        <li><a href="../_sources/deployment_configuration/deployment_configuration.txt"
               rel="nofollow">Show Source</a></li>
      </ul>
    <div id="searchbox" style="display: none">
      
        <form class="search" action="../search.html" method="get">
			<div class="search-wrapper">
			<span class="search-left"></span>
			<input class="prettysearch" type="text" name="q" size="18" />
			<span class="search-right">&nbsp;</span>
			</div>
          <input type="submit" value="Search" class="searchbutton" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
        <p class="searchtip" style="font-size: 90%">
        Enter search terms or a module, class or function name.
        </p>
    </div>
    <script type="text/javascript">$('#searchbox').show(0);</script>
  </div>
</div>



    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="id1">
<h1>4. 配備構成<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">スクリーンショットの一部はここに示すものと異なる場合があります。
すべてのケースの違いは、修飾的なもので操作に影響を及ぼしません。</p>
</div>
<p>このセクションの目的は、enStratusの配備構成オプションの中を歩きまわることです。</p>
<p><a href="#id2"><span class="problematic" id="id3">`</span></a>Overview &lt;../introduction/overview.html&gt;`セクションでは、我々は、enStratus配備の作成に関与した
概念を説明しました。
。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>配備構成にアプローチする前に、次のコンポーネンを手に入れる必要があります。：</p>
<ol class="last arabic simple">
<li>作業するマシンイメージ/テンプレートが有って、enStratusエージェントがインストールされてテストされていること。</li>
<li>インストールすべき各アプリケーション/データベースのサービスイメージ。</li>
</ol>
</div>
<p>enStratusはアプリケーション/データベースが実行される環境について知っていて、
その環境についての情報をサービスに通知します。</p>
<p>enStratusは完全に自動化された環境を配備、管理するすべてのツールを提供します。</p>
<div class="section" id="id4">
<h2>4.1. ユーザー　インタフェース<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>enStratus自動化インターフェイスは、直感的で操作しやすいように設計されています。enStratusコンソールには
対話作業と構成の自動化に関連するいくつかのセクションがあります。</p>
<p>配備デザイナのインターフェイスでは、enStratusのWebコンソールを使用してユーザーがアプリケーションの
アーキテクチャを構築します。</p>
<div class="section" id="diagram">
<h3>4.1.1. Diagram<a class="headerlink" href="#diagram" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/deploymentDiagram.png"><img alt="Deployment Designer" src="../_images/deploymentDiagram.png" style="width: 490.0px; height: 371.0px;" /></a>
<p class="caption">Deployment Designer (Diagram View)</p>
</div>
</div>
<div class="section" id="table">
<h3>4.1.2. Table<a class="headerlink" href="#table" title="Permalink to this headline">¶</a></h3>
<p>この配備では、1つのリージョンで2階層の層と2つの起動構成を持っています。
配備のグラフィカルな表現は、テーブルビューに切り替えることができます。</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/deploymentTable.png"><img alt="Deployment Designer (Table View)" src="../_images/deploymentTable.png" style="width: 450.0px; height: 225.0px;" /></a>
<p class="caption">Deployment Designer (Table View)</p>
</div>
</div>
<div class="section" id="id5">
<h3>4.1.3. 配備ダッシュボード<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>配備ダッシュボードは、関連する統計情報やその他の情報を配備管理者に表示します。</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/deploymentDashboard.png"><img alt="Deployment Dashboard" src="../_images/deploymentDashboard.png" style="width: 650.0px; height: 350.0px;" /></a>
<p class="caption">Deployment Dashboard</p>
</div>
</div>
</div>
<div class="section" id="id6">
<h2>4.2. 配備管理<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/deploymentManagement.png"><img alt="Deployment Management" src="../_images/deploymentManagement.png" style="width: 780.0px; height: 300.0px;" /></a>
<p class="caption">Deployment Management</p>
</div>
<p>配備の管理と構成が開始すると上記の図で示すオプションが表示されます。</p>
<ol class="arabic">
<li><p class="first"><strong>Name</strong></p>
<p>配備の名前は、enStratusコンソールに単に提示される論理名です。</p>
</li>
<li><p class="first"><strong>Label</strong></p>
<p>任意のカラーコードを配備に適用可能。</p>
</li>
<li><p class="first"><strong>Deployment Type</strong></p>
<p>配備タイプには、2つのオプションがあります。</p>
<ul>
<li><p>専用</p>
<p>専用の配備は、同じ課金コードに対してすべての配備コストを追跡します。</p>
</li>
<li><p>共用</p>
<p>共有の配備は、複数の課金コードに対して、配備コストを追跡します。
共有配備を選択した場合、課金コードの使用は、サービスレベルで追跡されます。</p>
</li>
</ul>
</li>
<li><p class="first"><strong>Disaster Recovery Storage</strong></p>
<p>ディザスタ　リカバリ　ストレージは、バックアップファイルにクラウド　ストレージ　オプションを指定します。
災害復旧目的で、/enstratus/bin/backupService を経由して1つのクラウド内のすべてまたは配備の一部を
他のクラウドに一括してバックアップ実行することが可能です。</p>
</li>
<li><p class="first"><strong>Billing Code</strong></p>
<p>課金コードは、すべての配備料が行われる対象となるコードです。</p>
</li>
<li><p class="first"><strong>Owner</strong></p>
<p>所有者は、ロールベースのアクセスコントロールが、配備に適用される場合があるので、
その配備のためのオプションの所有者を指定します。</p>
</li>
<li><p class="first"><strong>Description</strong></p>
<p>説明(&#8220;description&#8221;)は、配備を記述するための自由形式のテキストフィールドです。</p>
</li>
</ol>
<div class="section" id="id7">
<h3>4.2.1. バックアップ/メンテナンス<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/backupMaintenance.png"><img alt="Backup and Maintenance" src="../_images/backupMaintenance.png" style="width: 750.0px; height: 300.0px;" /></a>
<p class="caption">Backup and Maintenance</p>
</div>
<p>バックアップオプションでは、enStratusが何時バックアップを実行するかを設定します。
(接続されたボリュームのスナップショットまたは/enstratus/bin/backupServiceのエージェントスクリプトを介したサービスレベルのバックアップのような)</p>
</div>
<div class="section" id="id8">
<h3>4.2.2. サーバ/サービスの管理<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>これらのタブは配備で実行されている全てのサーバーの集約されたビューと配備にインストールされている全てのサービスを表示します。</p>
</div>
</div>
<div class="section" id="id9">
<h2>4.3. ロード·バランサ<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h2>
<p>ロードバランサは通常、複数のアプリケーション·サーバーにトラフィックを分散させます。 enStratusは
異なるメカニズムを介して複数のタイプのロードバランサをサポートしています。</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/loadBalancer.png"><img alt="Load Balancer" src="../_images/loadBalancer.png" style="width: 200.0px; height: 200.0px;" /></a>
<p class="caption">Load Balancer</p>
</div>
<div class="section" id="id10">
<h3>4.3.1. 物理的な<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<p>仮想マシンベースのロードバランサはロードバランサとして HA-Proxy、 mod-jk、 zeus を使用することができます。
サービスが、仮想マシンベースのロードバランサに接続されている場合、エージェントスクリプト /enstratus/bin/startProxy が使用され、
新しいアプリケーションサーバーがプールに参加したことをロードバランサに通知します。エージェントスクリプト /enstratus/bin/stopProxy が使用され、
アプリケーションサーバーがプールから去ったことを、ロード·バランサに通知します。</p>
</div>
<div class="section" id="elb">
<h3>4.3.2. 仮想（例：ELB）<a class="headerlink" href="#elb" title="Permalink to this headline">¶</a></h3>
<p>いくつかのクラウド　プロバイダーは仮想ロードバランサの形でサービス　ベースのロードバランシング
をサポートします。 AWSでは、これは弾性ロードバランサ（ELB）と呼ばれています。 cloudstackで（cloud.com）
クラウドでは、時にはこれをルータ仮想マシン（RVM）と呼びます。もしクラウド　プロバイダーが
この概念をAPIとしてサポートしているならば、enStratusはそれをサポートすることができます。</p>
<p>サービスが仮想ロードバランサに接続されていて、そのサービスが実行されている時にサーバーが
ロードバランサに追加されたりそこから削除される際にAPIの呼び出しを介して行われます。さらに、もし
ロードバランサは、特定のゾーンまたはゾーンへのトラフィックのバランスを取るために設定されているならば、
enStratusはアプリケーション·サーバーがこれらのゾーンでのみ開始されることを保証します。</p>
<p>ロードバランシングは、enStratusで <em>service</em> レベルでの配備に接続されています。
重要なポイントを手短に説明します。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">配備で複数のロードバランサを関連付けることができます。この機能は
クラウドをまたがるときや大規模なスケール、地理的に分散して作業するときに便利です。</p>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/addLoadBalancer.png"><img alt="Adding a Load Balancer" src="../_images/addLoadBalancer.png" style="width: 550.0px; height: 300.0px;" /></a>
<p class="caption">Adding a Load Balancer</p>
</div>
<p>ロードバランサのコンフィグレーションオプションは次のとおりです。</p>
<ol class="arabic">
<li><p class="first"><strong>Account</strong></p>
<p>アカウントには、ロードバランサがプロビジョニングされているアカウントを指定します。もし
管理者が複数のアカウントのメンバーであれば、ここで複数のオプションがあるかもしれません。
ロード·バランサが複数のクラウドにまたがっている可能性があります。たとえば、ロードバランサを、
EC2とcloud.comの両方で cloud.com cloud アプリケーションサーバーにプロビジョニングすることができます。</p>
</li>
<li><p class="first"><strong>Region</strong></p>
<p>クラウド内のリージョンにまたがってロード·バランサを持つことが可能です。たとえば、EC2
クラウドはこれを書いている時点で5つのリージョンを持っています。</p>
</li>
<li><p class="first"><strong>Scope</strong></p>
<p>スコープパラメータには、3つの異なる設定があります。</p>
</li>
</ol>
<blockquote>
<div><ul>
<li><p class="first"><strong>Global</strong></p>
<p>グローバル設定は、ロードバランサを、リージョン間でバランスをとります。
しかしELBなどの仮想ロードバランシングオファリングには無意味です。</p>
</li>
<li><p class="first"><strong>Regional</strong></p>
<p>リージョンのロードバランサは、1つのリージョンでのトラフィックのバランスを取り、
そのリージョンの内のすべてのデータセンターで均等にします。</p>
</li>
<li><p class="first"><strong>Data Center</strong></p>
<p>データセンターの設定は、特定のデータセンターでバランスをとります。このタイプの
ロードバランシングは、起動する前にデータセンター（ゾーン）を指定することができる、ELBのような
仮想ロードバランシングオファリングでのみ意味をもちます。この設定は、
そのようなオプションが存在しないVMベースのロードバランシングでは無意味です。。</p>
</li>
</ul>
</div></blockquote>
<p>enStratus内では3つのタイプのプロビジョニング可能なロード·バランサがあります。</p>
<ol class="arabic">
<li><p class="first"><strong>Cloud</strong></p>
<p>クラウドのロード バランサは、Amazon EC2の Elastic Load Balancerのような仮想ロードバランサです。
クラウド　プロバイダーがそのような概念を持たない場合は、オプションがありません。</p>
<p>オプションが提示されるには、クラウド　ロード　バランサがすでにプロビジョニング
されている必要があります。</p>
</li>
<li><p class="first"><strong>VM Dynamic</strong></p>
<p>VMの動的ロード　バランサは、その配備時にスタートすることを意味します。
enStratusは、仮想サーバを適切なリソースを使用した、指定されたテンプレートからのプロビジョニングをし、
指定されたファイアウォールにそれを起動します。VMの動的ロード　バランサがプロビジョニングされたならば、
自動回復の恩恵も受けます。</p>
</li>
<li><p class="first"><strong>VM Static</strong></p>
<p>VMの静的ロード·バランサは、VM上の /enstratus/bin/startProxy スクリプトを適切な時期に呼び出すことにより、
既存の仮想マシンをロードバランサに&#8221;変換&#8221;します。</p>
<p>現在、VMの静的ロード バランサには、自動回復の恩恵はありません。自動回復が望まれる場合、
代わりにVMの動的ロードバランサを使用します。</p>
</li>
</ol>
</div>
</div>
<div class="section" id="id11">
<h2>4.4. マシンイメージ/テンプレート<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">&#8220;ゴールデン&#8221;または&#8221;マスター&#8221;イメージを作成するのが一般的です。ベストプラクティスは、
特別な構成管理のタスクに適しているツールを利用することです。 enStratus
は Chef そして/または Puppetの両方の力を活用するができます。 enStratusも
このコンセプトの良い入門書となる独自の構成管理エンジンを提供しています。</p>
</div>
<p>マシンのイメージは、サーバーが開始されるテンプレートです。このドキュメントでは、高度に
イメージファイルの作成と保守のプロセスを熟知のしていることを想定しています。マシン保守の
バージョン管理に関しての方法が関心対象です。自動化環境では、配備を構成する前にenStratusエージェント
が、テンプレートにインストールされている <em>必要</em> があります。</p>
<div class="section" id="id12">
<h3>4.4.1. バージョン管理<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<p>配備で操作をしている場合、enStratusは、起動構成で使用してるマシンイメージのバージョン管理を援助
することができます。コンセプトはenStratusの自動展開機能の一部にあります。</p>
<p>要するに、配備において動作しているサーバーにパッチを当てます。そのパッチは、起動構成において
同様にパッチを当てられたAMI定義に適合して維持できることを確認する必要があります。
スケールまたは回復イベントが発生した場合に、新しく作成されたサーバのバージョンに
正しいマシンイメージを使用できる必要がありますから。</p>
</div>
<div class="section" id="id13">
<h3>4.4.2. 依存関係<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<p>enStratusには本当の依存関係は非常に少ないです。Javaに依存しますので、エージェントのサポートに必要な、
最新のJDKがインストールされていることを確認してください。自動化された配備環境で操作している時には
以下のソフトウェアをインストールすることをお勧めします。:</p>
<table border="1" class="docutils">
<colgroup>
<col width="28%" />
<col width="51%" />
<col width="21%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">パッケージ</th>
<th class="head">目的</th>
<th class="head">注意事項</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>zip</td>
<td>Backups</td>
<td>Recommended</td>
</tr>
<tr class="row-odd"><td>openssl</td>
<td>Adding Users</td>
<td><strong>Required</strong></td>
</tr>
<tr class="row-even"><td>unzip</td>
<td>Service install, backups</td>
<td>Recommended</td>
</tr>
<tr class="row-odd"><td>build-essential</td>
<td>OSSEC installation and more</td>
<td>Optional</td>
</tr>
<tr class="row-even"><td>xfsprogs</td>
<td>XFS filesystem functionality</td>
<td>Optional</td>
</tr>
<tr class="row-odd"><td>libapache2-mod-jk</td>
<td>mod_jk load balancing</td>
<td>Optional</td>
</tr>
<tr class="row-even"><td>postfix</td>
<td>Sending mail notifications</td>
<td>Optional</td>
</tr>
<tr class="row-odd"><td>cryptsetup</td>
<td>Encryption (LUKS)</td>
<td>Recommended</td>
</tr>
<tr class="row-even"><td>haproxy</td>
<td>Load Balancing</td>
<td>Optional</td>
</tr>
<tr class="row-odd"><td>cronolog</td>
<td>Logging</td>
<td>Optional</td>
</tr>
<tr class="row-even"><td>sysstat</td>
<td>OS metrics</td>
<td><strong>Required</strong></td>
</tr>
<tr class="row-odd"><td>secure-delete</td>
<td>Securely delete files</td>
<td>Recommended</td>
</tr>
<tr class="row-even"><td>mysql-server</td>
<td>Running MySQL Databases</td>
<td>Optional</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="id14">
<h2>4.5. サービス<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h2>
<p>サービスは、通常、tarで圧縮、またはgzipされた、ファイルの形式でソフトウェアオブジェクトです。
配備を設定する前に、サービスをクラウド　ストレージにアップロードする必要があります。</p>
<p>サービス &#8220;イメージ&#8221; はzipファイルで、enStratusにアップロードしてから、自動化配備環境を選択されて
使用されます。サービスは、層にインストールされており、いくつかの構成オプションを持ち、そのうちの一つは
依存関係として知られているサービス間の論理的な接続を達成することができます。</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/addServiceImage.png"><img alt="Add Service Image" src="../_images/addServiceImage.png" style="width: 300.0px; height: 150.0px;" /></a>
<p class="caption">Add Service Image</p>
</div>
<p>サービスイメージをアップロードするには、 Automation &gt; Service Images に移動して、ローカル　ファイル　システム
からサービスイメージを選択します。サービスイメージのアップロードが終了したら、層で
使用するためのオプションとして利用可能になります。</p>
</div>
<div class="section" id="id15">
<h2>4.6. データ·ソース<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h2>
<p>enStratusにデータソースをアップロードするには、 Automation &gt; Data Source に移動し、
データソースの追加を選択します。</p>
<p>データソースはデータベースのバックアップファイルにすることができます。たとえば、MySQLデータベースのデータ
ソースは .sql の拡張子を持つファイルによって表現されます。このファイルは、データソースが関連付けられている
サービスの開始および構成時にクラウドストレージからダウンロードされます。</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/addDataSource.png"><img alt="Add Data Source" src="../_images/addDataSource.png" style="width: 300.0px; height: 150.0px;" /></a>
<p class="caption">Add Data Source</p>
</div>
<p>Using
使用要領
%%%%%</p>
<p>Data sources are used when configuring a service. More is said about this in the
section on Tiers, which hold services. A data source is a database backup file, typically
in the form of a &#8220;dump&#8221; file of the form database1.sql. Data sources, like
services, should be uploaded into cloud storage before configuring the deployment.
サービスを設定するときにデータソースが使用されています。以上がこの程度と言われてい
サービスを保持層、上のセクションを参照してください。データソースは、通常、データベースのバックアップファイルです。
フォームdatabase1.sqlの&#8221;ダンプ&#8221;ファイルの形態であってもよい。データ·ソースのような
サービスは、展開を構成する前に、クラウド·ストレージにアップロードする必要があります。</p>
</div>
<div class="section" id="id16">
<h2>4.7. ボリューム<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h2>
<p>ボリュームは配備の開始時に起動構成の一部として設定されているパラメータに従って
enStratusによって自動的にプロビジョニングされます。 enStratusは、それがクラウド　プロバイダに存在して、
スケーリングおよびリカバリイベントを実行するとき、ボリュームを使用します。</p>
<p>ボリュームは、Linuxサーバーでは /mnt/services 上、そしてindowsサーバーでは H:/services 上にある
層で実行中のサーバーにマウントされています。サービスは自動的に serviceID が割り当てられ、
それは /mnt/services もしくは H:/services の a1234 形式のディレクトリになります。サービスへのパスは
フォーム /mnt/services/a1234 で、ここで a1234 は、自動的に生成された識別子になります。</p>
</div>
<div class="section" id="id17">
<h2>4.8. 起動構成<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h2>
<p>起動構成は仮想マシンをサポートするためにプロビジョニングされたリソースを管理する定義です。
1つのレベルでは、おおまかに言って、アマゾン AWS の small, medium, large, その他のような
クラウドによるサイズの定義とほぼ類似しています。
enStratusにとって、起動構成には、この定義が含まれていますが、それを超えてサーがーがその中でスタートする
ファイアウォールは勿論、ボリュームへの接続、レイディング、ボリュームの暗号化を含みます。</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/launchConfigurationHighlighted.png"><img alt="Launch Configuration" src="../_images/launchConfigurationHighlighted.png" style="width: 250.0px; height: 300.0px;" /></a>
<p class="caption">起動構成</p>
</div>
<p>Manage Launch Configuration, General Information
起動構成の管理、一般情報
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</p>
<blockquote>
<div></div></blockquote>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/launchConfigurationGeneralInformation.png"><img alt="Launch Configuration (General)" src="../_images/launchConfigurationGeneralInformation.png" style="width: 800.0px; height: 225.0px;" /></a>
<p class="caption">起動構成 (一般情報)</p>
</div>
<ol class="arabic">
<li><p><strong>サーバー名テンプレート</strong></p>
<p>サーバー名テンプレートは起動構成に従って開始されているサーバーに適用される名前をコントロールします。
起動構成の一部として、サーバー名の命名には、2つのアプローチがあります。</p>
<p>最初のアプローチは、このフィールドに単にハードコードに値をつけることです。その意味は
層が多くのサーバーを含んでスケールすることがあれば、それらはすべて許可された同じ名前が付けられますが、
、それはいつも望ましいわけではありません</p>
<p>上記の図に示すように、2番目のアプローチは、パラメータを使用することです。利用できる
パラメータは次のとおりです。</p>
<ul class="simple">
<li>{tier} このサーバーが実行されている層の名前</li>
<li>{group} 後方互換性のために、現在のところ層名で解決されます。</li>
<li>{count} このサーバーのカウント（層の1からの連続番号）。</li>
<li>{role} クラスタノード、独立したノード、MASTER、レプリカント、STANDALONEのうちのどれか一つ：
（文字列を小文字に変換する）</li>
<li>{type} 負荷、サービス、クラスタデータベース、複製データベース、UNKNOWNのいずれか：
（文字列を小文字に変換）</li>
<li>{zone} サーバが動作しているプロバイダのゾーンID。</li>
<li>{dc} 上記のゾーンと同じように解決します。</li>
<li>{region} サーバが動作しているプロバイダのリージョンID。</li>
<li>{ip} サーバの予約済みアドレス（パブリックIP）。</li>
<li>{year} サーバの起動時刻の年。</li>
<li>{day} サーバの起動時刻の日。</li>
<li>{hour} サーバの起動時刻の時間。</li>
<li>{minute} サーバの起動時刻の分。</li>
</ul>
<p>このアプローチはサーバーに一意の名前を付けるという、サーバーがインテリジェントな方法で[層に参加する/層から去る]利点があります。</p>
</li>
<li><p class="first"><strong>Recovery Point</strong></p>
<p>The recovery point parameter sets the amount of time enStratus will wait to begin a
recovery event of a failed server. A server is assumed to have failed if the agent is
unreachable, and the server is un-ping-able, or the server has stopped altogether and is
no longer being counted in the min/max.</p>
</li>
<li><p class="first"><strong>Use Encryption</strong></p>
<p>This setting determines whether volumes attached to servers are encrypted. This option is
currently only meaningful for Linux-based servers that can employ the Linux Unified Key
Setup. This type of encryption is file-system based encryption.</p>
</li>
<li><p class="first"><strong>Server Type</strong></p>
<p>There are five options for Server Type:</p>
<ul class="simple">
<li>Load balancer. This option specifies a launch configuration as a load balancer so
that servers in this tier will be treated as such.</li>
<li>Service General Service. This option identifies the servers governed by this launch
configuration as a generic service such as a web application.</li>
<li>Clustered Database A clustered database is a database that is not using replication and
is therefore treated as an independent entity.</li>
<li>Replicated Database A replicated database is a database that is set up to perform
replication.</li>
<li>Unknown Similar to a service, this is a generic entry for a service.</li>
</ul>
</li>
<li><p class="first"><strong>Snapshot Frequency</strong></p>
<p>This parameter sets the frequency with which enStratus automatically performs snapshots of
the attached volume. It is important to note that although there may be multiple servers
running as part of a tier, each with its own volume attached, enStratus will only snapshot
one of the volumes.</p>
<p>This highlights an important architectural consideration. Each server running in a tier
should be identical, as should the attached volumes. If variation is required in the
architecture between servers, that is an indication that an extra tier should be
configured.</p>
<p>Take care not to set the snapshot frequency too low. Snapshots lock the file system until
they are complete, which can impact your application performance. Additionally, most cloud
providers limit the number of snapshots that can be stored and if the setting is to a high
frequency, this limit may result in errors. Typically one snapshot per day is sufficient
for most applications.</p>
</li>
</ol>
<div class="section" id="machine-images">
<h3>4.8.1. Machine Images<a class="headerlink" href="#machine-images" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/launchConfigurationMachineImage.png"><img alt="Launch Configuration Machine Images" src="../_images/launchConfigurationMachineImage.png" style="width: 950.0px; height: 250.0px;" /></a>
<p class="caption">Launch Configuration Machine Images</p>
</div>
<ol class="arabic">
<li><p class="first"><strong>Primary Machine Image</strong></p>
<p>The primary machine image specifies the machine image that enStratus will use to start
servers in the tier.</p>
</li>
<li><p class="first"><strong>Primary Product</strong></p>
<p>The primary product will contain a list of options that is very cloud-specific. The figure
shows an option that is specific to the AWS EC2 provider. If you are using a different
cloud provider you will see other options present here.</p>
</li>
<li><p class="first"><strong>Secondary Machine Image</strong></p>
<p>The secondary machine image is a machine image of an optionally unique definition that
enStratus will use to launch subsequent servers from the secondary machine image definition.</p>
<p>The most logical implementation for using a secondary machine image is in the case of
replicated databases. The primary machine image would be used by enStratus to launch the
master database and all subsequent servers would function as slaves using the secondary
machine image.</p>
</li>
<li><p class="first"><strong>Secondary Product</strong></p>
<p>The secondary product defines the amount of virtual hardware provisioned in the same
manner as the primary product.</p>
</li>
</ol>
</div>
<div class="section" id="volumes">
<h3>4.8.2. Volumes<a class="headerlink" href="#volumes" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The volumes option is only present if the cloud provider features block storage.</p>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/launchConfigurationVolumes.png"><img alt="Launch Configuration, Volumes" src="../_images/launchConfigurationVolumes.png" style="width: 960.0px; height: 160.0px;" /></a>
<p class="caption">Launch Configuration, Volumes</p>
</div>
<p>The volumes specification determines the number and size of volumes that will be attached
to servers in the tier. The option to encrypt these volumes is specified as part of the
general configuration above.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/launchConfigurationFirewalls.png"><img alt="Launch Configuration, Firewalls" src="../_images/launchConfigurationFirewalls.png" style="width: 960.0px; height: 160.0px;" /></a>
<p class="caption">Launch Configuration, Firewalls</p>
</div>
<p>The firewall definition specifies the firewall into which servers in this launch
configuration are started.</p>
</div>
<div class="section" id="manage-servers-servers">
<h3>4.8.3. Manage Servers, Servers<a class="headerlink" href="#manage-servers-servers" title="Permalink to this headline">¶</a></h3>
<p>Selecting this tab will show the servers running as part of the selected launch
configuration.</p>
</div>
</div>
<div class="section" id="tier">
<h2>4.9. Tier<a class="headerlink" href="#tier" title="Permalink to this headline">¶</a></h2>
<p>A tier is a logically and physically scalable division that contain servers running. Tiers
may span one or more clouds, so it is possible to have a tier that starts by provisioning
servers in your private data center but &#8220;bursts&#8221; when demand dictates additional
infrastructure into a public cloud provider.</p>
<p>A launch configuration is logically contained within a tier. In fact, a tier cannot exist
in any region without a corresponding launch configuration.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/tierHighlighted.png"><img alt="Tier" src="../_images/tierHighlighted.png" style="width: 200.0px; height: 200.0px;" /></a>
<p class="caption">Tier</p>
</div>
<div class="section" id="manage-tier-general-information">
<h3>4.9.1. Manage Tier, General Information<a class="headerlink" href="#manage-tier-general-information" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/tierGeneralInformation.png"><img alt="Tier, General" src="../_images/tierGeneralInformation.png" style="width: 600.0px; height: 250.0px;" /></a>
<p class="caption">Tier, General Information</p>
</div>
<p>Managing a tier includes the capability to delete the tier or grant shell access for the
tier. If the tier is deleted, any associated launch configurations will also be deleted.
If the shell access option is selected, a dialog box will be presented to the
administrator for adding shell access to servers running in the tier.</p>
</div>
<div class="section" id="manage-tier-shell-access">
<h3>4.9.2. Manage Tier, Shell Access<a class="headerlink" href="#manage-tier-shell-access" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/tierShellAccess.png"><img alt="Tier, Shell Access" src="../_images/tierShellAccess.png" style="width: 500.0px; height: 150.0px;" /></a>
<p class="caption">Tier, Shell Access</p>
</div>
<p>When servers are started as part of ongoing tier operations, Users designated for shell
access will be granted shell access shortly after the server has registered with the
enStratus provisioning server.</p>
<p>The same requirements for shell access in individual servers apply, namely that the
firewall must be open on the port where SSH is running, and the user must have a public
key as part of their profile.</p>
</div>
<div class="section" id="tier-scaling-rules-scaling-rules">
<h3>4.9.3. Tier Scaling Rules, Scaling Rules<a class="headerlink" href="#tier-scaling-rules-scaling-rules" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/tierScalingRules.png"><img alt="Tier, Scaling Rules" src="../_images/tierScalingRules.png" style="width: 650.0px; height: 350.0px;" /></a>
<p class="caption">Tier, Scaling Rules</p>
</div>
<p>Scaling rules are where the parameters that govern the scaling of tier resources.</p>
<ol class="arabic">
<li><p class="first"><strong>Minimum Servers</strong></p>
<p>The minimum servers specification sets the minimum required number of servers that must be
kept running in the tier at all times. If the total number of running servers in the tier
falls below this threshold, an auto-recovery event will be triggered.</p>
</li>
<li><p class="first"><strong>Maximum Servers</strong></p>
<p>The maximum servers specification sets the maximum allowable number of servers for a tier.
If the demand on the tier is such that additional server resources are required, enStratus
will scale up to, but not exceed, this value.</p>
</li>
<li><p class="first"><strong>Scaling Rules</strong></p>
</li>
</ol>
<p>There are three options for scaling rules:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first"><strong>enStratus</strong></p>
<p>enStratus scaling options are the ones shown by default. Scaling behavior is
governed by certain &#8220;hardware&#8221; parameters described here.</p>
<p>enStratus can govern scaling events by monitoring the CPU load of the servers. The CPU
load is equal to: 15-minute load average/# of CPU. For example, if the system has 2 CPU
and the load average is 0.89, the CPU threshold reading is 0.445*100 = 44.5.</p>
<ul>
<li><p class="first">Lower CPU Threshold.
The lower bound on CPU threshold. If the threshold drops
below this level and there are more than the minimum number of servers running,
servers will be terminated due to the decreased demand.</p>
</li>
<li><p class="first">Upper CPU Threshold</p>
<p>The upper bound on CPU threshold. If the threshold rises above this level and there are
less than the maximum number of servers running, servers will be started to meet increased
demand.</p>
</li>
<li><p class="first">Lower RAM Threshold</p>
<p>The lower RAM threshold sets the lower bound on RAM usage on a percentage used basis. If
the threshold drops below this level and there are more than the minimum number of
required servers running, servers will be scaled down due to decreased demand.</p>
</li>
<li><p class="first">Upper RAM Threshold</p>
<p>The upper RAM threshold set the upper bound on RAM usage on a percentage used basis. If
the threshold is above this threshold and there is room available to scale, servers will
be scaled up due to increased demand.</p>
</li>
</ul>
</li>
<li><p class="first"><strong>Cloud</strong></p>
<p>enStratus can also trigger scaling events based on the properties of the cloud provider.
If your cloud provider has mechanisms in place to govern scaling, enStratus will defer to
them if the cloud option is selected.</p>
</li>
<li><p class="first"><strong>Custom</strong></p>
<p>Custom scaling rules are by far the most powerful method for controlling scaling events.
There are inherent problems with reading CPU load by default as CPU isn&#8217;t really all
that meaningful of a concept when working in a multi-tenant cloud environment where actual
CPU are load shared.</p>
<p>In short, custom scaling with enStratus means that on an interval of about 30s, enStratus
will read the output of a script called /enstratus/bin/scaleCheck. The scaleCheck script
that controls scaling behavior signals enStratus to scale up, do nothing, or scale down by
returning 1, 0, or -1, respectively.</p>
<p>A voting mechanism is used by enStratus to determine whether or not to scale the number of
servers in a group. Essentially, if the majority of servers in a server group
&#8220;vote&#8221; to scale up by returning 1, a new server will be started. If the majority
of servers in a server group vote to scale down by returning -1, a random server in that
group will be terminated. If most servers vote 0, no scaling will occur.</p>
<p>Here is an example of a scaleCheck script that was written to provide a mechanism for
applying a normalization factor to &#8220;small&#8221; servers running in EC2.</p>
</li>
</ol>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In all cases, enStratus manages the actions of initiating the scale. Each
scaling event is a server launch, and all of the orchestration/automation around that
launch is controlled using the parameters set in enStratus</p>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span class="c">#!/bin/bash</span>
<span class="nv">stat</span><span class="o">=</span><span class="k">$(</span>uptime | awk <span class="s1">&#39;{print $12}&#39;</span> | sed <span class="s1">&#39;s/,//g&#39;</span><span class="k">)</span>
<span class="nb">time</span><span class="o">=</span><span class="k">$(</span> date +%H:%M:%S <span class="k">)</span>

<span class="nv">MAX_THRESHOLD</span><span class="o">=</span>0.75
<span class="nv">SCALE_FACTOR</span><span class="o">=</span>0.35

<span class="k">if</span> <span class="o">[</span> ! -e statFile <span class="o">]</span>;
        <span class="k">then </span>touch statFile
        cat &gt; statFile <span class="s">&lt;&lt; STOP_HERE</span>
<span class="s">MAX=1.00</span>
<span class="s">MIN=0.32</span>
<span class="s">STOP_HERE</span>
<span class="k">fi</span>

<span class="nv">SCALED_LOAD</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$stat</span> <span class="k">${</span><span class="nv">SCALE_FACTOR</span><span class="k">}</span>| awk <span class="s1">&#39;{print $1*$2}&#39;</span><span class="k">)</span>

<span class="c">#echo &quot;Actual Load: $stat&quot;</span>
<span class="c">#echo &quot;Scaled Load: $SCALED_LOAD&quot;</span>

<span class="nv">DO_SCALE</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$SCALED_LOAD</span> <span class="nv">$MAX_THRESHOLD</span> | awk <span class="s1">&#39;{if ($1 &gt; $2) print &quot;1&quot;; else print &quot;0&quot;}&#39;</span><span class="k">)</span>

<span class="k">function </span>checkMax<span class="o">(){</span>
        <span class="nv">NEW_MAX</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$1</span> <span class="nv">$2</span> | awk <span class="s1">&#39;{if ($1 &gt; $2) print &quot;1&quot;; else print &quot;0&quot;}&#39;</span><span class="k">)</span>
        <span class="c">#echo &quot;Is this a new max: $NEW_MAX&quot;</span>
        <span class="k">if</span> <span class="o">[</span> <span class="nv">$NEW_MAX</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span> <span class="o">]</span>; <span class="k">then</span>
<span class="k">                </span>sed -i <span class="s2">&quot;s/MAX=${2}/MAX=${1}/&quot;</span> statFile
        <span class="k">fi</span>
<span class="o">}</span>

<span class="k">function </span>checkMin<span class="o">(){</span>
        <span class="nv">NEW_MIN</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$1</span> <span class="nv">$2</span> | awk <span class="s1">&#39;{if ($1 &lt; $2) print &quot;1&quot;; else print &quot;0&quot;}&#39;</span><span class="k">)</span>
        <span class="c">#echo &quot;Is this a new min: $NEW_MIN&quot;</span>
        <span class="k">if</span> <span class="o">[</span> <span class="nv">$NEW_MIN</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span> <span class="o">]</span>; <span class="k">then</span>
<span class="k">                </span>sed -i <span class="s2">&quot;s/MIN=${2}/MIN=${1}/&quot;</span> statFile
        <span class="k">fi</span>
<span class="o">}</span>

<span class="c">#echo &quot;Should we scale? $DO_SCALE&quot;</span>

<span class="nb">source </span>statFile

checkMax <span class="nv">$SCALED_LOAD</span> <span class="nv">$MAX</span>
checkMin <span class="nv">$SCALED_LOAD</span> <span class="nv">$MIN</span>

<span class="nb">echo</span> <span class="nv">$DO_SCALE</span>
</pre></div>
</div>
</div>
<div class="section" id="scaling-sensitivity">
<h3>4.9.4. Scaling Sensitivity<a class="headerlink" href="#scaling-sensitivity" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first"><strong>Breach Period</strong></p>
<p>The amount of time for which the load average must exceed the upper CPU threshold before a
scaling event will occur resulting in more servers.</p>
</li>
<li><p class="first"><strong>Cooldown Period</strong></p>
<p>The amount of time for which the load average must be below the lower CPU threshold before
a scaling event will occur resulting in less servers.
The breach and cooldown periods control the &#8220;sensitivity&#8221; of the scaling behavior.</p>
</li>
<li><p class="first"><strong>Breach Increment</strong></p>
<p>The breach increment controls the size of the &#8220;step&#8221; enStratus uses to scale up or
down. If the minimum and maximum number of servers specification is such that there is
room to scale, enStratus will do so by the number of servers specified in the breach
increment.</p>
<p>For example if the minimum and maximum values are 2 and 10, respectively, and the breach
increment is 2, if demand requires extra resources, the first scaling action will result
in 4 servers. The same principle applies to scaling down as it does when scaling up.</p>
</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If enStratus scaling rules are in place, enStratus reads the values presented to it
via a file called /mnt/tmp/stats.properties, that is a product of the
/enstratus/bin/calculateAgentData script.</p>
</div>
</div>
<div class="section" id="id18">
<h3>4.9.5. Manage Servers, Servers<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h3>
<p>Selecting this tab will show the servers running as part of the selected tier. The view
will aggregate the server list across all regions in the tier.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/tierServers.png"><img alt="Tier, Servers" src="../_images/tierServers.png" style="width: 700.0px; height: 200.0px;" /></a>
<p class="caption">Tier, Servers</p>
</div>
</div>
<div class="section" id="manage-services-services">
<h3>4.9.6. Manage Services, Services<a class="headerlink" href="#manage-services-services" title="Permalink to this headline">¶</a></h3>
<p>From here it is possible to interact with services. To add a service to a tier, first
select the tier from the diagram. Next navigate to the Manage Service tab shown above.
Choose Add Service.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/addServiceToTier.png"><img alt="Tier, Add Service" src="../_images/addServiceToTier.png" style="width: 300.0px; height: 250.0px;" /></a>
<p class="caption">Tier, Add Service</p>
</div>
<p>A list of available services will be presented. Adding a service requires fairly minimal
information. The more interesting part of services is in the configuration.</p>
<p>Selecting this option will present the services that are connected to this tier.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/tierManageService.png"><img alt="Tier, Services" src="../_images/tierManageService.png" style="width: 700.0px; height: 200.0px;" /></a>
<p class="caption">Tier, Services</p>
</div>
<p>Using the same process, a service was also added to the Database tier. To view all
services, select the deployment and choose Manage Services. This will cause the console to
display all of the services installed in all tiers on the deployment.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/allServices.png"><img alt="Tier, All Services" src="../_images/allServices.png" style="width: 700.0px; height: 200.0px;" /></a>
<p class="caption">Tier, All Services</p>
</div>
</div>
<div class="section" id="configuring-services">
<h3>4.9.7. Configuring Services<a class="headerlink" href="#configuring-services" title="Permalink to this headline">¶</a></h3>
<p>Configuring services controls options such as the port upon which the services listen for
incoming traffic, credentials, and dependencies. To view the configuration options
associated with a service, click on the green action button for the service:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/serviceActions.png"><img alt="Service, Actions" src="../_images/serviceActions.png" style="width: 400.0px; height: 300.0px;" /></a>
<p class="caption">Service, Actions</p>
</div>
</div>
<div class="section" id="launch">
<h3>4.9.8. Launch<a class="headerlink" href="#launch" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>Launch is an option that is reserved for starting services on an already running
deployment. On the service, enStratus will call the script called
/mnt/services/$serviceID/bin/enstratus-start.</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the deployment is not running, this action is meaningless.</p>
</div>
</div>
<div class="section" id="edit">
<h3>4.9.9. Edit<a class="headerlink" href="#edit" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/editService.png"><img alt="Service, Edit" src="../_images/editService.png" style="width: 400.0px; height: 300.0px;" /></a>
<p class="caption">Service, Edit</p>
</div>
<p>Editing a service presents several options. The options presented here control how
enStratus treats your service and what information is passed to your service when changes
occur.</p>
<ol class="arabic" start="3">
<li><p class="first"><strong>Backup Frequency</strong></p>
<p>The backup frequency setting controls the frequency with which enStratus calls any custom
backup script located in /mnt/services/$serviceID/enstratus/bin/enstratus-backupService.
This is a service level backup and enStratus will store the resulting backup file in
cloud storage.</p>
</li>
<li><p class="first"><strong>Configuration</strong></p>
<p>Configuration is a free form text field that allows an administrator to pass in sensitive
information to the service. This information makes its way directly into the
enstratus.cfg file that is passed as an argument to the
/mnt/services/$serviceID/bin/enstratus-configure as necessary during scaling and starting
events. Remember that the enstratus.cfg file is securely erased after it is used.</p>
</li>
<li><p class="first">Run as User</p>
<p>The run as user controls the user enStratus will use to start the service.</p>
</li>
<li><p class="first">Service Image</p>
<p>The service image is the service image that will be used for the specified service.
Service images must first be uploaded via Automation &gt; Service Images.</p>
</li>
<li><p class="first">Scaling Model</p>
<p>The scaling model has four options:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first"><strong>None</strong></p>
<p>This option means that no special action will be taken during scaling beyond the
normal scaling mechanism.</p>
</li>
<li><p class="first"><strong>Load Balanced</strong></p>
<p>This option tells enStratus to notify a load balancer when a scaling
event occurs that affects this service.</p>
</li>
<li><p class="first"><strong>Replicated Database</strong></p>
<p>This option tells enStratus to treat the first server started in a tier as a master
and all subsequent servers as slaves. Please refer to the MySQL service image for
more information about this process.</p>
</li>
<li><p class="first"><strong>Clustered Database</strong></p>
<p>This option tells enStratus to treat all database servers as peers with no
master/slave relationship.</p>
</li>
</ol>
</div></blockquote>
</li>
<li><p class="first">SSL Certificate</p>
<p>SSL Certificates may be uploaded to enStratus via the interface at Infrastructure &gt; SSL.</p>
</li>
</ol>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/sslCertificate.png"><img alt="SSL, Add" src="../_images/sslCertificate.png" style="width: 400.0px; height: 300.0px;" /></a>
<p class="caption">SSL, Add</p>
</div>
<p>If a certificate has been uploaded to enStratus, it will be present as an option and
securely passed in to the servers at launch via the /enstratus/bin/configureService script
and ultimately to the user-defined /mnt/services/$serviceID/bin/enstratus-configure script
for use in configuring the service.</p>
<p>In this option, the SSL certificates are passed to the application servers.</p>
<ol class="arabic" start="7">
<li><p class="first"><strong>Load Balancer SSL</strong></p>
<p>Checking this option will allow the administrator to specify the load balancer as a target
for the SSL certificate. This option is only available for virtual machine based load
balancers.</p>
<p>SSL certificates may be available to cloud based load balancers, and must be configured
via your cloud provider as not all cloud support this option.</p>
</li>
<li><p class="first"><strong>Billing Code</strong></p>
<p>It is possible to track tier costs against a billing code. Different tiers within the same
deployment may have different billing codes.</p>
</li>
<li><p class="first"><strong>Owning Group</strong></p>
<p>The owning group will specify the group attribute for the service.</p>
</li>
</ol>
</div>
<div class="section" id="ports">
<h3>4.9.10. Ports<a class="headerlink" href="#ports" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/servicePorts.png"><img alt="Service, Ports" src="../_images/servicePorts.png" style="width: 400.0px; height: 200.0px;" /></a>
<p class="caption">Service, Ports</p>
</div>
<p>Adding a service port to a service will configure enStratus to pass in the relevant port
information to the service via the enstratus.cfg file. If there is a load balancer
connected to the deployment, it will appear in the Load Balancers selection window. If a
load balancer is selected, enStratus will ensure that servers that have this service
installed upon them are connected to the load balancer upon start.</p>
<p>More specifically, if you have virtual machine-based load balancer specified, and an
application server has a service installed that is connected to the load balancer,
enStratus will call /enstratus/bin/startProxy on the load balancer after the service is
configured on the application server.</p>
<p>If a cloud based load balancer such as an elastic load balancer (ELB), enStratus will call
the correct API command to connect that server to the ELB. The cloud based load balancer
must be configured beforehand to pass traffic on the correct ports and protocols.</p>
<p>The relevant section of the enstratus.cfg file for ports is shown here:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>enstratus<span class="o">]</span>
port.80.protocol<span class="o">=</span>TCP
port.80.publicPort<span class="o">=</span>80
port.80.privatePort<span class="o">=</span>80
</pre></div>
</div>
<p>Credentials are also securely passed to the service via the enstratus.cfg file during
deployment start. What happens to these credentials is determined by the actions taken by
the enstratus-configure script which should be written by the application/service architect.</p>
</div>
<div class="section" id="credentials">
<h3>4.9.11. Credentials<a class="headerlink" href="#credentials" title="Permalink to this headline">¶</a></h3>
<p>Credentials are also securely passed to the service via the enstratus.cfg file during
deployment start. What happens to these credentials is determined by the actions taken by
the enstratus-configure script which should be written by the application/service
architect.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/serviceCredentials.png"><img alt="Service, Credentials" src="../_images/serviceCredentials.png" style="width: 350.0px; height: 300.0px;" /></a>
<p class="caption">Service, Credentials</p>
</div>
<p>The relevant section of the enstratus.cfg file for credentials is here:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>enstratus<span class="o">]</span>
<span class="nv">serviceKeys</span><span class="o">=</span>admin
serviceKey.admin.user<span class="o">=</span>adminUser
serviceKey.admin.password<span class="o">=</span>trustno1
</pre></div>
</div>
<p>This configuration option controls the information that is passed to services via the
enstratus.cfg file. What happens to this information is determined by the actions
specified in the enstratus-configure script written by your application architect.</p>
</div>
<div class="section" id="data-sources">
<h3>4.9.12. Data Sources<a class="headerlink" href="#data-sources" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/serviceDataSources.png"><img alt="Service, Data Soruce" src="../_images/serviceDataSources.png" style="width: 400.0px; height: 200.0px;" /></a>
<p class="caption">Service, Data Soruce</p>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/serviceEditDataSource.png"><img alt="Data Source, Edit" src="../_images/serviceEditDataSource.png" style="width: 400.0px; height: 300.0px;" /></a>
<p class="caption">Data Source, Edit</p>
</div>
<p>A data source is tied only to database services. Data sources are database backup files
such as a datasource.sql file that have been uploaded to enStratus for use in deployments
via Automation &gt; Data Sources.</p>
<p>The figure above displays the data source configuration for a MySQL service. The available
configuration options for data sources and their functions are described here:</p>
<ol class="arabic">
<li><p class="first"><strong>Name</strong></p>
<p>The name is a logical name for the data source as it will appear in the enStratus console.</p>
</li>
<li><p class="first"><strong>Name in Database</strong></p>
<p>This configuration option ultimately becomes the name of the database itself as in the
case of a MySQL service.</p>
</li>
<li><p class="first"><strong>Description</strong></p>
<p>A text description of the service for human reference.</p>
</li>
<li><p class="first"><strong>Label</strong></p>
<p>An optional color code that will be applied to the service in the enStratus console.</p>
</li>
<li><p class="first"><strong>Service User</strong></p>
<p>The service user will be the user on the server that owns the service.</p>
</li>
<li><p class="first"><strong>Backup Frequency</strong></p>
<p>This configuration option specifies the frequency with which enStratus calls the agent
script called /enstratus/bin/backupService. The function of this script is to call a
user-configured script called /mnt/services/$serviceID/bin/enstratus-backupDataSource. If
this script exists, enStratus will execute it and place the resulting file into cloud
storage. If not, this is a nonoperational event.</p>
</li>
<li><p class="first"><strong>Service Password</strong></p>
<p>This parameter will become the password that can be used to connect to the data source</p>
</li>
<li><p class="first"><strong>Custom Configuration</strong></p>
<p>The custom configuration option is a free-form text field that can be used to pass
information to the enstratus-configure script at the time of service configuration. This
information will be contained within the enstratus.cfg file.</p>
</li>
<li><p class="first"><strong>Data Source Image</strong></p>
<p>The data source image is the database dump file that will be used to initialize the
database named in the Name in Database field.</p>
</li>
<li><p class="first"><strong>Owning Group</strong></p>
<p>The owning group can be assigned to the service if role based access controls are being
used.</p>
</li>
</ol>
</div>
<div class="section" id="dependencies">
<h3>4.9.13. Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/serviceDependencies.png"><img alt="Service, Dependencies" src="../_images/serviceDependencies.png" style="width: 500.0px; height: 150.0px;" /></a>
<p class="caption">Service, Dependencies</p>
</div>
<p>Creating an dependency means establishing a logical connection between services. For
example, an application service may have a dependency on a database service. Perhaps even
more meaningful than that, an application service may have a dependency on a database data
source.</p>
<p>Operationally, if there exists a dependency between two services, when there are changes
that affect either service such as an auto-recovery or an auto-scaling event, the other
service is notified by enStratus of this environmental change.</p>
<p>This notification process is conducted using the enstratus.cfg file which is passed to all
affected services in a tier.</p>
<p>In the figure above, an application service has a dependency on a data source installed on
a database service. If there is an auto-recovery event on a database server housing the
data source, the application services that depend on it will be notified when enStratus
passes in a new enstratus.cfg file to each of them.</p>
<p>Similarly, when changes such as an auto-recovery or an auto-scaling event occur on servers
housing the application service, the database service will be notified as well to grant or
revoke database access as necessary to compensate for changes at the application tier.
The takeaway message for dependencies is that dependencies establish logical relationships
between services that ensure the required information is passed when environment
changes occur such as a scale or recovery of a server that is running an affected service.</p>
</div>
<div class="section" id="delete">
<h3>4.9.14. Delete<a class="headerlink" href="#delete" title="Permalink to this headline">¶</a></h3>
<p>Deleting a service will remove it from a tier.</p>
</div>
<div class="section" id="versioning">
<h3>4.9.15. Versioning<a class="headerlink" href="#versioning" title="Permalink to this headline">¶</a></h3>
<p>Maintaining the most recent version of a service is dependent somewhat on the cloud
provider. If your cloud provider has a concept of attachable block storage devices and
your services are installed upon one of them that is regularly being snapshotted, it may
be acceptable to rely on this mechanism for maintaing the most recent software. Update
your services on the running volumes, and the updates will persist once the next snapshot
is taken.</p>
<p>This approach is dependent upon the enStratus auto-recovery and scaling procedures. It is
advisable to also update the service images that are defined for each service in a tier by
uploading a new service image via Infrastructure &gt; Service Images and then pointing the
service definition to the newest version.</p>
<p>If your cloud provider has no concept of attachable block storage devices, the only option
is to take the approach of uploading the new, updated service image via Infrastructure &gt;
Service images and then pointing the service definition to the newest version.</p>
</div>
</div>
<div class="section" id="ssl">
<h2>4.10. SSL<a class="headerlink" href="#ssl" title="Permalink to this headline">¶</a></h2>
<p>SSL certificates may be uploaded to enStratus where they will be protected via the same
encryption methods as any credentials for the customer account. SSL certificates should
not be imaged onto servers, rather, they should be installed in an automated on-demand
fashion at the time of server start.</p>
<div class="section" id="creating">
<h3>4.10.1. Creating<a class="headerlink" href="#creating" title="Permalink to this headline">¶</a></h3>
<p>Create SSL certificates by any method you desire. enStratus will inform the administrator
via an alert when the SSL cerfiticate is set to expire via a message of the form:</p>
<div class="highlight-python"><pre>New Cloud Event: Tue 07 Nov 2010 12:28:59 UTC
Cloud: Rackspace
Account: enStratus RS NOC
Subject: NEW EVENT #315741 (Severity 3) - SSL Certificate 'My CERT' EXPIRING: Sun Dec 12
00:00:00 UTC 2010

Customer ID: 9999
Customer: enStratus
Address: www.company.org
Expiration: Sun Dec 12 00:00:00 UTC 2010

The SSL certificate MPLS attached to www.company.org will soon expire.


If you need assistance understanding this message or if you believe this message is the
result of an issue with enStratus, please visit our support site at
https://support.enstratus.com and login with your standard enStratus login credentials.

To check on the status of enStratus itself, visit: http://status.enstratus.com

Subscribe to live status updates via RSS at http://status.enstratus.com/status.xml or via
Twitter at http://www.twitter.com/enStratusStatus.
</pre>
</div>
</div>
<div class="section" id="uploading">
<h3>4.10.2. Uploading<a class="headerlink" href="#uploading" title="Permalink to this headline">¶</a></h3>
<p>To upload your certificate to enStratus, navigate to Infrastructure &gt; SSL Certificates as
shown:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/sslCertificate.png"><img alt="SSL, Upload" src="../_images/sslCertificate.png" style="width: 400.0px; height: 250.0px;" /></a>
<p class="caption">SSL, Upload</p>
</div>
</div>
<div class="section" id="updating">
<h3>4.10.3. Updating<a class="headerlink" href="#updating" title="Permalink to this headline">¶</a></h3>
<p>To update your SSL certificate, choose an existing certificate from the list and update
the necessary fields, then save.</p>
</div>
<div class="section" id="using">
<h3>4.10.4. Using<a class="headerlink" href="#using" title="Permalink to this headline">¶</a></h3>
<p>Data sources are used when configuring a service. More is said about this in the section
on Tiers, which hold services.</p>
</div>
</div>
<div class="section" id="backups">
<h2>4.11. Backups<a class="headerlink" href="#backups" title="Permalink to this headline">¶</a></h2>
<p>Backups occur according the the parameters specified in the Launch Configuration
configuration. As snapshots and occur, they are tracked in the Automation &gt; Backups part
of the enStratus console.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/deploymentBackups.png"><img alt="Deployment Backups" src="../_images/deploymentBackups.png" style="width: 700.0px; height: 250.0px;" /></a>
<p class="caption">Deployment Backups</p>
</div>
</div>
</div>


          </div> 
        </div>
      </div>
    <div class="footer">
    <p>
      &copy; Copyright 2012, enStratus Networks Inc..
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
	</p>
    </div>
      <div class="clearer"></div>
    </div>
	<div id="breadcrumbs">
		4. 配備構成
		</ul>
	</div>
	<script type="text/javascript" charset="utf-8" src="../_static/toc.js"></script>
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30212947-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>
  </body>
</html>